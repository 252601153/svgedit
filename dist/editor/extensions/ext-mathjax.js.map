{"version":3,"file":"ext-mathjax.js","sources":["../../../src/editor/extensions/ext-mathjax.js"],"sourcesContent":["/* globals MathJax */\n/**\n * @file ext-mathjax.js\n *\n * @license MIT\n *\n * @copyright 2013 Jo Segaert\n *\n */\n\nexport default {\n  name: 'mathjax',\n  async init ({$, importLocale}) {\n    const strings = await importLocale();\n    const svgEditor = this;\n    const svgCanvas = svgEditor.canvas;\n\n    // Configuration of the MathJax extention.\n\n    // This will be added to the head tag before MathJax is loaded.\n    const /* mathjaxConfiguration = `<script type=\"text/x-mathjax-config\">\n        MathJax.Hub.Config({\n          extensions: ['tex2jax.js'],\n          jax: ['input/TeX', 'output/SVG'],\n          showProcessingMessages: true,\n          showMathMenu: false,\n          showMathMenuMSIE: false,\n          errorSettings: {\n            message: ['[Math Processing Error]'],\n            style: {color: '#CC0000', 'font-style': 'italic'}\n          },\n          elements: [],\n            tex2jax: {\n            ignoreClass: 'tex2jax_ignore2', processClass: 'tex2jax_process2',\n          },\n          TeX: {\n            extensions: ['AMSmath.js', 'AMSsymbols.js', 'noErrors.js', 'noUndefined.js']\n          },\n          SVG: {\n          }\n      });\n      </script>`, */\n      // mathjaxSrc = 'http://cdn.mathjax.org/mathjax/latest/MathJax.js',\n      // Had been on https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js\n      // Obtained Text-AMS-MML_SVG.js from https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.3/config/TeX-AMS-MML_SVG.js\n      mathjaxSrcSecure = 'mathjax/MathJax.min.js?config=TeX-AMS-MML_SVG.js',\n      {uiStrings} = svgEditor;\n    let\n      math,\n      locationX,\n      locationY,\n      mathjaxLoaded = false;\n\n    // TODO: Implement language support. Move these uiStrings to the locale files and\n    //   the code to the langReady callback. Also i18nize alert and HTML below\n    $.extend(uiStrings, {\n      mathjax: {\n        embed_svg: 'Save as mathematics',\n        embed_mathml: 'Save as figure',\n        svg_save_warning: 'The math will be transformed into a figure is ' +\n          'manipulatable like everything else. You will not be able to ' +\n          'manipulate the TeX-code anymore.',\n        mathml_save_warning: 'Advised. The math will be saved as a figure.',\n        title: 'Mathematics code editor'\n      }\n    });\n\n    /**\n     *\n     * @returns {void}\n     */\n    function saveMath () {\n      const code = $('#mathjax_code_textarea').val();\n      // displaystyle to force MathJax NOT to use the inline style. Because it is\n      // less fancy!\n      MathJax.Hub.queue.Push(['Text', math, '\\\\displaystyle{' + code + '}']);\n\n      /*\n       * The MathJax library doesn't want to bloat your webpage so it creates\n       * every symbol (glymph) you need only once. These are saved in a `<svg>` on\n       * the top of your html document, just under the body tag. Each glymph has\n       * its unique id and is saved as a `<path>` in the `<defs>` tag of the `<svg>`\n       *\n       * Then when the symbols are needed in the rest of your html document they\n       * are refferd to by a `<use>` tag.\n       * Because of bug 1076 we can't just grab the defs tag on the top and add it\n       * to your formula's `<svg>` and copy the lot. So we have to replace each\n       * `<use>` tag by its `<path>`.\n       */\n      MathJax.Hub.queue.Push(\n        function () {\n          const mathjaxMath = $('.MathJax_SVG');\n          const svg = $(mathjaxMath.html());\n          svg.find('use').each(function () {\n            // TODO: find a less pragmatic and more elegant solution to this.\n            const id = $(this).attr('href')\n              ? $(this).attr('href').slice(1) // Works in Chrome.\n              : $(this).attr('xlink:href').slice(1); // Works in Firefox.\n            const glymph = $('#' + id).clone().removeAttr('id');\n            const x = $(this).attr('x');\n            const y = $(this).attr('y');\n            const transform = $(this).attr('transform');\n            if (transform && (x || y)) {\n              glymph.attr('transform', transform + ' translate(' + x + ',' + y + ')');\n            } else if (transform) {\n              glymph.attr('transform', transform);\n            } else if (x || y) {\n              glymph.attr('transform', 'translate(' + x + ',' + y + ')');\n            }\n            $(this).replaceWith(glymph);\n          });\n          // Remove the style tag because it interferes with SVG-Edit.\n          svg.removeAttr('style');\n          svg.attr('xmlns', 'http://www.w3.org/2000/svg');\n          svgCanvas.importSvgString($('<div>').append(svg.clone()).html(), true);\n          svgCanvas.ungroupSelectedElement();\n          // TODO: To undo the adding of the Formula you now have to undo twice.\n          // This should only be once!\n          svgCanvas.moveSelectedElements(locationX, locationY, true);\n        }\n      );\n    }\n\n    const buttons = [{\n      id: 'tool_mathjax',\n      type: 'mode',\n      icon: 'mathjax.png',\n      events: {\n        async click () {\n          // Set the mode.\n          svgCanvas.setMode('mathjax');\n\n          // Only load Mathjax when needed, we don't want to strain Svg-Edit any more.\n          // From this point on it is very probable that it will be needed, so load it.\n          if (mathjaxLoaded === false) {\n            $(\n              '<div id=\"mathjax\">' +\n              '<!-- Here is where MathJax creates the math -->' +\n                '<div id=\"mathjax_creator\" class=\"tex2jax_process\" style=\"display:none\">' +\n                  '$${}$$' +\n                '</div>' +\n                '<div id=\"mathjax_overlay\"></div>' +\n                '<div id=\"mathjax_container\">' +\n                  '<div id=\"tool_mathjax_back\" class=\"toolbar_button\">' +\n                    '<button id=\"tool_mathjax_save\">OK</button>' +\n                    '<button id=\"tool_mathjax_cancel\">Cancel</button>' +\n                  '</div>' +\n                  '<fieldset>' +\n                    '<legend id=\"mathjax_legend\">Mathematics Editor</legend>' +\n                    '<label>' +\n                      '<span id=\"mathjax_explication\">Please type your mathematics in ' +\n                      '<a href=\"https://en.wikipedia.org/wiki/Help:' +\n                        'Displaying_a_formula\" target=\"_blank\">TeX</a> code.' +\n                        '</span></label>' +\n                    '<textarea id=\"mathjax_code_textarea\" spellcheck=\"false\"></textarea>' +\n                  '</fieldset>' +\n                '</div>' +\n              '</div>'\n            ).insertAfter('#svg_prefs').hide();\n\n            // Make the MathEditor draggable.\n            $('#mathjax_container').draggable({\n              cancel: 'button,fieldset',\n              containment: 'window'\n            });\n\n            // Add functionality and picture to cancel button.\n            $('#tool_mathjax_cancel').prepend($.getSvgIcon('cancel', true))\n              .on('click touched', function () {\n                $('#mathjax').hide();\n              });\n\n            // Add functionality and picture to the save button.\n            $('#tool_mathjax_save').prepend($.getSvgIcon('ok', true))\n              .on('click touched', function () {\n                saveMath();\n                $('#mathjax').hide();\n              });\n\n            // MathJax preprocessing has to ignore most of the page.\n            $('body').addClass('tex2jax_ignore');\n\n            // Now get (and run) the MathJax Library.\n            // Todo: insert script with modules once widely supported\n            //   and if MathJax (and its `TeX-AMS-MML_SVG.js` dependency) ends up\n            //   providing an ES6 module export: https://github.com/mathjax/MathJax/issues/1998\n            /*\n            const modularVersion = !('svgEditor' in window) ||\n              !window.svgEditor ||\n              window.svgEditor.modules !== false;\n            // Add as second argument to `importScript`\n            {\n              type: modularVersion\n                ? 'module' // Make this the default when widely supported\n                : 'text/javascript'\n            }\n            // If only using modules, just use this:\n            const {default: MathJax} = await importModule( // or `import()` when widely supported\n              svgEditor.curConfig.extIconsPath + mathjaxSrcSecure\n            );\n            */\n            // We use `extIconsPath` here for now as it does not vary with\n            //  the modular type as does `extPath`\n            try {\n              // eslint-disable-next-line node/no-unsupported-features/es-syntax\n              await import(mathjaxSrcSecure);\n              // When MathJax is loaded get the div where the math will be rendered.\n              MathJax.Hub.queue.Push(function () {\n                math = MathJax.Hub.getAllJax('#mathjax_creator')[0];\n                console.log(math); // eslint-disable-line no-console\n                mathjaxLoaded = true;\n                console.log('MathJax Loaded'); // eslint-disable-line no-console\n              });\n            } catch (e) {\n              console.log('Failed loading MathJax.'); // eslint-disable-line no-console\n              $.alert('Failed loading MathJax. You will not be able to change the mathematics.');\n            }\n          }\n        }\n      }\n    }];\n\n    return {\n      name: strings.name,\n      svgicons: 'mathjax-icons.xml',\n      buttons: strings.buttons.map((button, i) => {\n        return Object.assign(buttons[i], button);\n      }),\n\n      mouseDown () {\n        if (svgCanvas.getMode() === 'mathjax') {\n          return {started: true};\n        }\n        return undefined;\n      },\n      mouseUp (opts) {\n        if (svgCanvas.getMode() === 'mathjax') {\n          // Get the coordinates from your mouse.\n          const zoom = svgCanvas.getZoom();\n          // Get the actual coordinate by dividing by the zoom value\n          locationX = opts.mouse_x / zoom;\n          locationY = opts.mouse_y / zoom;\n\n          $('#mathjax').show();\n          return {started: false}; // Otherwise the last selected object dissapears.\n        }\n        return undefined;\n      },\n      callback () {\n        $('<style>').text(\n          '#mathjax fieldset{' +\n            'padding: 5px;' +\n            'margin: 5px;' +\n            'border: 1px solid #DDD;' +\n          '}' +\n          '#mathjax label{' +\n            'display: block;' +\n            'margin: .5em;' +\n          '}' +\n          '#mathjax legend {' +\n            'max-width:195px;' +\n          '}' +\n          '#mathjax_overlay {' +\n            'position: absolute;' +\n            'top: 0;' +\n            'left: 0;' +\n            'right: 0;' +\n            'bottom: 0;' +\n            'background-color: black;' +\n            'opacity: 0.6;' +\n            'z-index: 20000;' +\n          '}' +\n          '#mathjax_container {' +\n            'position: absolute;' +\n            'top: 50px;' +\n            'padding: 10px;' +\n            'background-color: #B0B0B0;' +\n            'border: 1px outset #777;' +\n            'opacity: 1.0;' +\n            'font-family: Verdana, Helvetica, sans-serif;' +\n            'font-size: .8em;' +\n            'z-index: 20001;' +\n          '}' +\n          '#tool_mathjax_back {' +\n            'margin-left: 1em;' +\n            'overflow: auto;' +\n          '}' +\n          '#mathjax_legend{' +\n            'font-weight: bold;' +\n            'font-size:1.1em;' +\n          '}' +\n          '#mathjax_code_textarea {\\\\n' +\n            'margin: 5px .7em;' +\n            'overflow: hidden;' +\n            'width: 416px;' +\n            'display: block;' +\n            'height: 100px;' +\n          '}'\n        ).appendTo('head');\n\n        // Add the MathJax configuration.\n        // $(mathjaxConfiguration).appendTo('head');\n      }\n    };\n  }\n};\n"],"names":["name","init","saveMath","code","$","val","MathJax","Hub","queue","Push","math","mathjaxMath","svg","html","find","each","id","attr","slice","glymph","clone","removeAttr","x","y","transform","replaceWith","svgCanvas","importSvgString","append","ungroupSelectedElement","moveSelectedElements","locationX","locationY","importLocale","strings","svgEditor","canvas","mathjaxSrcSecure","uiStrings","mathjaxLoaded","extend","mathjax","embed_svg","embed_mathml","svg_save_warning","mathml_save_warning","title","buttons","type","icon","events","click","setMode","insertAfter","hide","draggable","cancel","containment","prepend","getSvgIcon","on","addClass","getAllJax","console","log","alert","svgicons","map","button","i","Object","assign","mouseDown","getMode","started","undefined","mouseUp","opts","zoom","getZoom","mouse_x","mouse_y","show","callback","text","appendTo"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}