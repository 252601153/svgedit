{"version":3,"file":"ext-shapes.js","sources":["../../../src/editor/extensions/ext-shapes.js"],"sourcesContent":["/**\n * @file ext-shapes.js\n *\n * @license MIT\n *\n * @copyright 2010 Christian Tzurcanu, 2010 Alexis Deveria\n *\n */\n\nexport default {\n  name: 'shapes',\n  async init ({$, importLocale}) {\n    const strings = await importLocale();\n    const svgEditor = this;\n    const canv = svgEditor.canvas;\n    const svgroot = canv.getRootElem();\n    let lastBBox = {};\n\n    // This populates the category list\n    const {categories} = strings;\n    /* eslint-disable max-len */\n    const library = {\n      basic: {\n        data: {\n          heart: 'm150,73c61,-175 300,0 0,225c-300,-225 -61,-400 0,-225z',\n          frame: 'm0,0l300,0l0,300l-300,0zm35,-265l0,230l230,0l0,-230z',\n          donut: 'm1,150l0,0c0,-82.29042 66.70958,-149 149,-149l0,0c39.51724,0 77.41599,15.69816 105.35889,43.64108c27.94293,27.94293 43.64111,65.84165 43.64111,105.35892l0,0c0,82.29041 -66.70958,149 -149,149l0,0c-82.29041,0 -149,-66.70959 -149,-149zm74.5,0l0,0c0,41.1452 33.35481,74.5 74.5,74.5c41.14522,0 74.5,-33.3548 74.5,-74.5c0,-41.1452 -33.3548,-74.5 -74.5,-74.5l0,0c-41.14519,0 -74.5,33.35481 -74.5,74.5z',\n          triangle: 'm1,280.375l149,-260.75l149,260.75z',\n          right_triangle: 'm1,299l0,-298l298,298z',\n          diamond: 'm1,150l149,-149l149,149l-149,149l-149,-149z',\n          pentagon: 'm1.00035,116.97758l148.99963,-108.4053l148.99998,108.4053l-56.91267,175.4042l-184.1741,0l-56.91284,-175.4042z',\n          hexagon: 'm1,149.99944l63.85715,-127.71428l170.28572,0l63.85713,127.71428l-63.85713,127.71428l-170.28572,0l-63.85715,-127.71428z',\n          septagon1: 'm0.99917,191.06511l29.51249,-127.7108l119.48833,-56.83673l119.48836,56.83673l29.51303,127.7108l-82.69087,102.41679l-132.62103,0l-82.69031,-102.41679z',\n          heptagon: 'm1,88.28171l87.28172,-87.28171l123.43653,0l87.28172,87.28171l0,123.43654l-87.28172,87.28172l-123.43653,0l-87.28172,-87.28172l0,-123.43654z',\n          decagon: 'm1,150.00093l28.45646,-88.40318l74.49956,-54.63682l92.08794,0l74.50002,54.63682l28.45599,88.40318l-28.45599,88.40318l-74.50002,54.63681l-92.08794,0l-74.49956,-54.63681l-28.45646,-88.40318z',\n          dodecagon: 'm1,110.07421l39.92579,-69.14842l69.14842,-39.92579l79.85159,0l69.14842,39.92579l39.92578,69.14842l0,79.85159l-39.92578,69.14842l-69.14842,39.92578l-79.85159,0l-69.14842,-39.92578l-39.92579,-69.14842l0,-79.85159z',\n          star_points_5: 'm1,116.58409l113.82668,0l35.17332,-108.13487l35.17334,108.13487l113.82666,0l-92.08755,66.83026l35.17514,108.13487l-92.08759,-66.83208l-92.08757,66.83208l35.17515,-108.13487l-92.08758,-66.83026z',\n          trapezoid: 'm1,299l55.875,-298l186.25001,0l55.87498,298z',\n          arrow_up: 'm1.49805,149.64304l148.50121,-148.00241l148.50121,148.00241l-74.25061,0l0,148.71457l-148.5012,0l0,-148.71457z',\n          vertical_scrool: 'm37.375,261.625l0,-242.9375l0,0c0,-10.32083 8.36669,-18.6875 18.6875,-18.6875l224.25,0c10.32083,0 18.6875,8.36667 18.6875,18.6875c0,10.32081 -8.36667,18.6875 -18.6875,18.6875l-18.6875,0l0,242.9375c0,10.32083 -8.36668,18.6875 -18.6875,18.6875l-224.25,0l0,0c-10.32083,0 -18.6875,-8.36667 -18.6875,-18.6875c0,-10.32083 8.36667,-18.6875 18.6875,-18.6875zm37.375,-261.625l0,0c10.32081,0 18.6875,8.36667 18.6875,18.6875c0,10.32081 -8.36669,18.6875 -18.6875,18.6875c-5.1604,0 -9.34375,-4.18335 -9.34375,-9.34375c0,-5.16041 4.18335,-9.34375 9.34375,-9.34375l18.6875,0m186.875,18.6875l-205.5625,0m-37.375,224.25l0,0c5.1604,0 9.34375,4.18335 9.34375,9.34375c0,5.1604 -4.18335,9.34375 -9.34375,9.34375l18.6875,0m-18.6875,18.6875l0,0c10.32081,0 18.6875,-8.36667 18.6875,-18.6875l0,-18.6875',\n          smiley: 'm68.49886,214.78838q81.06408,55.67332 161.93891,0m-144.36983,-109.9558c0,-8.60432 6.97517,-15.57949 15.57948,-15.57949c8.60431,0 15.57948,6.97517 15.57948,15.57949c0,8.60431 -6.97517,15.57947 -15.57948,15.57947c-8.60431,0 -15.57948,-6.97516 -15.57948,-15.57947m95.83109,0c0,-8.60432 6.97517,-15.57949 15.57948,-15.57949c8.60431,0 15.57947,6.97517 15.57947,15.57949c0,8.60431 -6.97516,15.57947 -15.57947,15.57947c-8.60429,0 -15.57948,-6.97516 -15.57948,-15.57947m-181.89903,44.73038l0,0c0,-82.60133 66.96162,-149.56296 149.56296,-149.56296c82.60135,0 149.56296,66.96162 149.56296,149.56296c0,82.60135 -66.96161,149.56296 -149.56296,149.56296c-82.60133,0 -149.56296,-66.96161 -149.56296,-149.56296zm0,0l0,0c0,-82.60133 66.96162,-149.56296 149.56296,-149.56296c82.60135,0 149.56296,66.96162 149.56296,149.56296c0,82.60135 -66.96161,149.56296 -149.56296,149.56296c-82.60133,0 -149.56296,-66.96161 -149.56296,-149.56296z',\n          left_braket: 'm174.24565,298.5c-13.39009,0 -24.24489,-1.80908 -24.24489,-4.04065l0,-140.4187c0,-2.23158 -10.85481,-4.04065 -24.2449,-4.04065l0,0c13.39009,0 24.2449,-1.80907 24.2449,-4.04065l0,-140.4187l0,0c0,-2.23159 10.8548,-4.04066 24.24489,-4.04066',\n          uml_actor: 'm40.5,100l219,0m-108.99991,94.00006l107,105m-107.00009,-106.00006l-100,106m99.5,-231l0,125m33.24219,-158.75781c0,18.35916 -14.88303,33.24219 -33.24219,33.24219c-18.35916,0 -33.2422,-14.88303 -33.2422,-33.24219c0.00002,-18.35915 14.88304,-33.24219 33.2422,-33.24219c18.35916,0 33.24219,14.88304 33.24219,33.24219z',\n          dialog_balloon_1: 'm0.99786,35.96579l0,0c0,-19.31077 15.28761,-34.96524 34.14583,-34.96524l15.52084,0l0,0l74.50001,0l139.68748,0c9.05606,0 17.74118,3.68382 24.14478,10.24108c6.40356,6.55726 10.00107,15.45081 10.00107,24.72416l0,87.41311l0,0l0,52.44785l0,0c0,19.31078 -15.2876,34.96524 -34.14584,34.96524l-139.68748,0l-97.32507,88.90848l22.82506,-88.90848l-15.52084,0c-18.85822,0 -34.14583,-15.65446 -34.14583,-34.96524l0,0l0,-52.44785l0,0z',\n          cloud: 'm182.05086,34.31005c-0.64743,0.02048 -1.27309,0.07504 -1.92319,0.13979c-10.40161,1.03605 -19.58215,7.63722 -24.24597,17.4734l-2.47269,7.44367c0.53346,-2.57959 1.35258,-5.08134 2.47269,-7.44367c-8.31731,-8.61741 -19.99149,-12.59487 -31.52664,-10.72866c-11.53516,1.8662 -21.55294,9.3505 -27.02773,20.19925c-15.45544,-9.51897 -34.72095,-8.94245 -49.62526,1.50272c-14.90431,10.44516 -22.84828,28.93916 -20.43393,47.59753l1.57977,7.58346c-0.71388,-2.48442 -1.24701,-5.01186 -1.57977,-7.58346l-0.2404,0.69894c-12.95573,1.4119 -23.58103,11.46413 -26.34088,24.91708c-2.75985,13.45294 2.9789,27.25658 14.21789,34.21291l17.54914,4.26352c-6.1277,0.50439 -12.24542,-0.9808 -17.54914,-4.26352c-8.66903,9.71078 -10.6639,24.08736 -4.94535,35.96027c5.71854,11.87289 17.93128,18.70935 30.53069,17.15887l7.65843,-2.02692c-2.46413,1.0314 -5.02329,1.70264 -7.65843,2.02692c7.15259,13.16728 19.01251,22.77237 32.93468,26.5945c13.92217,3.82214 28.70987,1.56322 41.03957,-6.25546c10.05858,15.86252 27.91113,24.19412 45.81322,21.38742c17.90208,-2.8067 32.66954,-16.26563 37.91438,-34.52742l1.82016,-10.20447c-0.27254,3.46677 -0.86394,6.87508 -1.82016,10.20447c12.31329,8.07489 27.80199,8.52994 40.52443,1.18819c12.72244,-7.34175 20.6609,-21.34155 20.77736,-36.58929l-4.56108,-22.7823l-17.96776,-15.41455c13.89359,8.70317 22.6528,21.96329 22.52884,38.19685c16.5202,0.17313 30.55292,-13.98268 36.84976,-30.22897c6.29684,-16.24631 3.91486,-34.76801 -6.2504,-48.68089c4.21637,-10.35873 3.96622,-22.14172 -0.68683,-32.29084c-4.65308,-10.14912 -13.23602,-17.69244 -23.55914,-20.65356c-2.31018,-13.45141 -11.83276,-24.27162 -24.41768,-27.81765c-12.58492,-3.54603 -25.98557,0.82654 -34.41142,11.25287l-5.11707,8.63186c1.30753,-3.12148 3.01521,-6.03101 5.11707,-8.63186c-5.93959,-8.19432 -15.2556,-12.8181 -24.96718,-12.51096z',\n          cylinder: 'm299.0007,83.77844c0,18.28676 -66.70958,33.11111 -149.00002,33.11111m149.00002,-33.11111l0,0c0,18.28676 -66.70958,33.11111 -149.00002,33.11111c-82.29041,0 -148.99997,-14.82432 -148.99997,-33.11111m0,0l0,0c0,-18.28674 66.70956,-33.1111 148.99997,-33.1111c82.29044,0 149.00002,14.82436 149.00002,33.1111l0,132.44449c0,18.28674 -66.70958,33.11105 -149.00002,33.11105c-82.29041,0 -148.99997,-14.82431 -148.99997,-33.11105z',\n          arrow_u_turn: 'm1.00059,299.00055l0,-167.62497l0,0c0,-72.00411 58.37087,-130.37499 130.375,-130.37499l0,0l0,0c34.57759,0 67.73898,13.7359 92.18906,38.18595c24.45006,24.45005 38.18593,57.61144 38.18593,92.18904l0,18.625l37.24997,0l-74.49995,74.50002l-74.50002,-74.50002l37.25,0l0,-18.625c0,-30.8589 -25.0161,-55.87498 -55.87498,-55.87498l0,0l0,0c-30.85892,0 -55.875,25.01608 -55.875,55.87498l0,167.62497z',\n          arrow_left_up: 'm0.99865,224.5l74.50004,-74.5l0,37.25l111.74991,0l0,-111.75l-37.25,0l74.5,-74.5l74.5,74.5l-37.25,0l0,186.25l-186.24989,0l0,37.25l-74.50005,-74.5z',\n          maximize: 'm1.00037,150.34581l55.30305,-55.30267l0,27.65093l22.17356,0l0,-44.21833l44.21825,0l0,-22.17357l-27.65095,0l55.30267,-55.30292l55.3035,55.30292l-27.65175,0l0,22.17357l44.21835,0l0,44.21833l22.17357,0l0,-27.65093l55.30345,55.30267l-55.30345,55.3035l0,-27.65175l-22.17357,0l0,44.21834l-44.21835,0l0,22.17355l27.65175,0l-55.3035,55.30348l-55.30267,-55.30348l27.65095,0l0,-22.17355l-44.21825,0l0,-44.21834l-22.17356,0l0,27.65175l-55.30305,-55.3035z',\n          cross: 'm0.99844,99.71339l98.71494,0l0,-98.71495l101.26279,0l0,98.71495l98.71495,0l0,101.2628l-98.71495,0l0,98.71494l-101.26279,0l0,-98.71494l-98.71494,0z',\n          plaque: 'm-0.00197,49.94376l0,0c27.5829,0 49.94327,-22.36036 49.94327,-49.94327l199.76709,0l0,0c0,27.5829 22.36037,49.94327 49.94325,49.94327l0,199.7671l0,0c-27.58289,0 -49.94325,22.36034 -49.94325,49.94325l-199.76709,0c0,-27.58292 -22.36037,-49.94325 -49.94327,-49.94325z',\n          page: 'm249.3298,298.99744l9.9335,-39.73413l39.73413,-9.93355l-49.66763,49.66768l-248.33237,0l0,-298.00001l298.00001,0l0,248.33234'\n\n        },\n        buttons: []\n      }\n    };\n    /* eslint-enable max-len */\n    const modeId = 'shapelib';\n    const startClientPos = {};\n\n    let currentD, curShapeId, curShape, startX, startY;\n    let curLib = library.basic;\n\n    /**\n    *\n    * @returns {void}\n    */\n    function loadIcons () {\n      $('#shape_buttons').empty().append(curLib.buttons);\n    }\n\n    /**\n    * @typedef {PlainObject} module:Extension.Shapes.Shapes\n    * @property {PlainObject<string, string>} data\n    * @property {Integer} [size]\n    * @property {boolean} [fill]\n    */\n\n    /**\n    * @param {string|\"basic\"} cat Category ID\n    * @param {module:Extension.Shapes.Shapes} shapes\n    * @returns {void}\n    */\n    function makeButtons (cat, shapes) {\n      const size = curLib.size || 300;\n      const fill = curLib.fill || false;\n      const off = size * 0.05;\n      const vb = [-off, -off, size + off * 2, size + off * 2].join(' ');\n      const stroke = fill ? 0 : (size / 30);\n      const shapeIcon = new DOMParser().parseFromString(\n        '<svg xmlns=\"http://www.w3.org/2000/svg\">' +\n          '<svg viewBox=\"' + vb + '\">' +\n            '<path fill=\"' + (fill ? '#333' : 'none') +\n              '\" stroke=\"#000\" stroke-width=\"' + stroke + '\" /></svg></svg>',\n        'text/xml'\n      );\n\n      const width = 24;\n      const height = 24;\n      shapeIcon.documentElement.setAttribute('width', width);\n      shapeIcon.documentElement.setAttribute('height', height);\n      const svgElem = $(document.importNode(shapeIcon.documentElement, true));\n\n      const {data} = shapes;\n\n      curLib.buttons = Object.entries(data).map(([id, pathD]) => {\n        const icon = svgElem.clone();\n        icon.find('path').attr('d', pathD);\n\n        const iconBtn = icon.wrap('<div class=\"tool_button\">').parent().attr({\n          id: modeId + '_' + id,\n          title: id\n        });\n        // Store for later use\n        return iconBtn[0];\n      });\n    }\n\n    /**\n    * @param {string|\"basic\"} catId\n    * @returns {void}\n    */\n    function loadLibrary (catId) {\n      const lib = library[catId];\n\n      if (!lib) {\n        $('#shape_buttons').html(strings.loading);\n        $.getJSON('./shapelib/' + catId + '.json', function (result) {\n          curLib = library[catId] = {\n            data: result.data,\n            size: result.size,\n            fill: result.fill\n          };\n          makeButtons(catId, result);\n          loadIcons();\n        });\n        return;\n      }\n      curLib = lib;\n      if (!lib.buttons.length) { makeButtons(catId, lib); }\n      loadIcons();\n    }\n    const buttons = [{\n      id: 'tool_shapelib',\n      icon: 'shapes.png',\n      type: 'mode_flyout', // _flyout\n      position: 6,\n      events: {\n        click () {\n          canv.setMode(modeId);\n        }\n      }\n    }];\n\n    return {\n      svgicons: 'ext-shapes.xml',\n      buttons: strings.buttons.map((button, i) => {\n        return Object.assign(buttons[i], button);\n      }),\n      callback () {\n        $('<style>').text(`\n          #shape_buttons {\n            overflow: auto;\n            width: 180px;\n            max-height: 300px;\n            display: table-cell;\n            vertical-align: middle;\n          }\n          #shape_cats {\n            min-width: 110px;\n            display: table-cell;\n            vertical-align: middle;\n            height: 300px;\n          }\n          #shape_cats > div {\n            line-height: 1em;\n            padding: .5em;\n            border:1px solid #B0B0B0;\n            background: #E8E8E8;\n            margin-bottom: -1px;\n          }\n          #shape_cats div:hover {\n            background: #FFFFCC;\n          }\n          #shape_cats div.current {\n            font-weight: bold;\n          }\n        `).appendTo('head');\n\n        const btnDiv = $('<div id=\"shape_buttons\">');\n        $('#tools_shapelib > *').wrapAll(btnDiv);\n\n        const shower = $('#tools_shapelib_show');\n\n        loadLibrary('basic');\n\n        // Do mouseup on parent element rather than each button\n        $('#shape_buttons').mouseup(function (evt) {\n          const btn = $(evt.target).closest('div.tool_button');\n\n          if (!btn.length) { return; }\n\n          const copy = btn.children().clone();\n          shower.children(':not(.flyout_arrow_horiz)').remove();\n          shower\n            .append(copy)\n            .attr('data-curopt', '#' + btn[0].id) // This sets the current mode\n            .mouseup();\n          canv.setMode(modeId);\n\n          curShapeId = btn[0].id.substr((modeId + '_').length);\n          currentD = curLib.data[curShapeId];\n\n          $('.tools_flyout').fadeOut();\n        });\n\n        const shapeCats = $('<div id=\"shape_cats\">');\n\n        let catStr = '';\n        $.each(categories, function (id, label) {\n          catStr += '<div data-cat=' + id + '>' + label + '</div>';\n        });\n\n        shapeCats.html(catStr).children().bind('mouseup', function () {\n          const catlink = $(this);\n          catlink.siblings().removeClass('current');\n          catlink.addClass('current');\n\n          loadLibrary(catlink.attr('data-cat'));\n          // Get stuff\n          return false;\n        });\n\n        shapeCats.children().eq(0).addClass('current');\n\n        $('#tools_shapelib').append(shapeCats);\n\n        shower.mouseup(function () {\n          canv.setMode(currentD ? modeId : 'select');\n        });\n        $('#tool_shapelib').remove();\n\n        const h = $('#tools_shapelib').height();\n        $('#tools_shapelib').css({\n          'margin-top': -(h / 2 - 15),\n          'margin-left': 3\n        });\n        // Now add shape categories from locale\n        const cats = {};\n        Object.entries(categories).forEach(([o, categoryName]) => {\n          cats['#shape_cats [data-cat=\"' + o + '\"]'] = categoryName;\n        });\n        this.setStrings('content', cats);\n      },\n      mouseDown (opts) {\n        const mode = canv.getMode();\n        if (mode !== modeId) { return undefined; }\n\n        startX = opts.start_x;\n        const x = startX;\n        startY = opts.start_y;\n        const y = startY;\n        const curStyle = canv.getStyle();\n\n        startClientPos.x = opts.event.clientX;\n        startClientPos.y = opts.event.clientY;\n\n        curShape = canv.addSVGElementFromJson({\n          element: 'path',\n          curStyles: true,\n          attr: {\n            d: currentD,\n            id: canv.getNextId(),\n            opacity: curStyle.opacity / 2,\n            style: 'pointer-events:none'\n          }\n        });\n\n        // Make sure shape uses absolute values\n        if ((/[a-z]/).test(currentD)) {\n          currentD = curLib.data[curShapeId] = canv.pathActions.convertPath(curShape);\n          curShape.setAttribute('d', currentD);\n          canv.pathActions.fixEnd(curShape);\n        }\n        curShape.setAttribute('transform', 'translate(' + x + ',' + y + ') scale(0.005) translate(' + -x + ',' + -y + ')');\n\n        canv.recalculateDimensions(curShape);\n\n        /* const tlist = */ canv.getTransformList(curShape);\n\n        lastBBox = curShape.getBBox();\n\n        return {\n          started: true\n        };\n      },\n      mouseMove (opts) {\n        const mode = canv.getMode();\n        if (mode !== modeId) { return; }\n\n        const zoom = canv.getZoom();\n        const evt = opts.event;\n\n        const x = opts.mouse_x / zoom;\n        const y = opts.mouse_y / zoom;\n\n        const tlist = canv.getTransformList(curShape),\n          box = curShape.getBBox(),\n          left = box.x, top = box.y;\n          // {width, height} = box,\n        // const dx = (x - startX), dy = (y - startY);\n\n        const newbox = {\n          x: Math.min(startX, x),\n          y: Math.min(startY, y),\n          width: Math.abs(x - startX),\n          height: Math.abs(y - startY)\n        };\n\n        /*\n        // This is currently serving no purpose, so commenting out\n        let sy = height ? (height + dy) / height : 1,\n          sx = width ? (width + dx) / width : 1;\n        */\n\n        let sx = (newbox.width / lastBBox.width) || 1;\n        let sy = (newbox.height / lastBBox.height) || 1;\n\n        // Not perfect, but mostly works...\n        let tx = 0;\n        if (x < startX) {\n          tx = lastBBox.width;\n        }\n        let ty = 0;\n        if (y < startY) {\n          ty = lastBBox.height;\n        }\n\n        // update the transform list with translate,scale,translate\n        const translateOrigin = svgroot.createSVGTransform(),\n          scale = svgroot.createSVGTransform(),\n          translateBack = svgroot.createSVGTransform();\n\n        translateOrigin.setTranslate(-(left + tx), -(top + ty));\n        if (!evt.shiftKey) {\n          const max = Math.min(Math.abs(sx), Math.abs(sy));\n\n          sx = max * (sx < 0 ? -1 : 1);\n          sy = max * (sy < 0 ? -1 : 1);\n        }\n        scale.setScale(sx, sy);\n\n        translateBack.setTranslate(left + tx, top + ty);\n        tlist.appendItem(translateBack);\n        tlist.appendItem(scale);\n        tlist.appendItem(translateOrigin);\n\n        canv.recalculateDimensions(curShape);\n\n        lastBBox = curShape.getBBox();\n      },\n      mouseUp (opts) {\n        const mode = canv.getMode();\n        if (mode !== modeId) { return undefined; }\n\n        const keepObject = (opts.event.clientX !== startClientPos.x && opts.event.clientY !== startClientPos.y);\n\n        return {\n          keep: keepObject,\n          element: curShape,\n          started: false\n        };\n      }\n    };\n  }\n};\n"],"names":["name","init","loadIcons","makeButtons","loadLibrary","catId","lib","library","$","html","strings","loading","getJSON","result","curLib","data","size","fill","buttons","length","cat","shapes","off","vb","join","stroke","shapeIcon","DOMParser","parseFromString","width","height","documentElement","setAttribute","svgElem","document","importNode","Object","entries","map","id","pathD","icon","clone","find","attr","iconBtn","wrap","parent","modeId","title","empty","append","importLocale","svgEditor","canv","canvas","svgroot","getRootElem","lastBBox","categories","basic","heart","frame","donut","triangle","right_triangle","diamond","pentagon","hexagon","septagon1","heptagon","decagon","dodecagon","star_points_5","trapezoid","arrow_up","vertical_scrool","smiley","left_braket","uml_actor","dialog_balloon_1","cloud","cylinder","arrow_u_turn","arrow_left_up","maximize","cross","plaque","page","startClientPos","type","position","events","click","setMode","svgicons","button","i","assign","callback","text","appendTo","btnDiv","wrapAll","shower","mouseup","evt","btn","target","closest","copy","children","remove","curShapeId","substr","currentD","fadeOut","shapeCats","catStr","each","label","bind","catlink","siblings","removeClass","addClass","eq","h","css","cats","forEach","o","categoryName","setStrings","mouseDown","opts","mode","getMode","undefined","startX","start_x","x","startY","start_y","y","curStyle","getStyle","event","clientX","clientY","curShape","addSVGElementFromJson","element","curStyles","d","getNextId","opacity","style","test","pathActions","convertPath","fixEnd","recalculateDimensions","getTransformList","getBBox","started","mouseMove","zoom","getZoom","mouse_x","mouse_y","tlist","box","left","top","newbox","Math","min","abs","sx","sy","tx","ty","translateOrigin","createSVGTransform","scale","translateBack","setTranslate","shiftKey","max","setScale","appendItem","mouseUp","keepObject","keep"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}