{"version":3,"file":"ext-placemark.js","sources":["../../../src/editor/extensions/ext-placemark.js"],"sourcesContent":["/**\n * @file ext-placemark.js\n *\n *\n * @copyright 2010 CloudCanvas, Inc. All rights reserved\n *\n */\nexport default {\n  name: 'placemark',\n  async init (S) {\n    const svgEditor = this;\n    const svgCanvas = svgEditor.canvas;\n    const addElem = svgCanvas.addSVGElementFromJson;\n    const {$, importLocale} = S; // {svgcontent},\n    let\n      selElems,\n      // editingitex = false,\n      // svgdoc = S.svgroot.parentNode.ownerDocument,\n      started,\n      newPM;\n      // edg = 0,\n      // newFOG, newFOGParent, newDef, newImageName, newMaskID,\n      // undoCommand = 'Not image',\n      // modeChangeG, ccZoom, wEl, hEl, wOffset, hOffset, ccRgbEl, brushW, brushH;\n    const strings = await importLocale();\n    const markerTypes = {\n      nomarker: {},\n      forwardslash:\n        {element: 'path', attr: {d: 'M30,100 L70,0'}},\n      reverseslash:\n        {element: 'path', attr: {d: 'M30,0 L70,100'}},\n      verticalslash:\n        {element: 'path', attr: {d: 'M50,0 L50,100'}},\n      xmark:\n        {element: 'path', attr: {d: 'M20,80 L80,20 M80,80 L20,20'}},\n      leftarrow:\n        {element: 'path', attr: {d: 'M0,50 L100,90 L70,50 L100,10 Z'}},\n      rightarrow:\n        {element: 'path', attr: {d: 'M100,50 L0,90 L30,50 L0,10 Z'}},\n      box:\n        {element: 'path', attr: {d: 'M20,20 L20,80 L80,80 L80,20 Z'}},\n      star:\n        {element: 'path', attr: {d: 'M10,30 L90,30 L20,90 L50,10 L80,90 Z'}},\n      mcircle:\n        {element: 'circle', attr: {r: 30, cx: 50, cy: 50}},\n      triangle:\n        {element: 'path', attr: {d: 'M10,80 L50,20 L80,80 Z'}}\n    };\n\n    // duplicate shapes to support unfilled (open) marker types with an _o suffix\n    ['leftarrow', 'rightarrow', 'box', 'star', 'mcircle', 'triangle'].forEach((v) => {\n      markerTypes[v + '_o'] = markerTypes[v];\n    });\n\n    /**\n     *\n     * @param {boolean} on\n     * @returns {void}\n     */\n    function showPanel (on) {\n      $('#placemark_panel').toggle(on);\n    }\n\n    /**\n    * @param {Element} elem - A graphic element will have an attribute like marker-start\n    * @param {\"marker-start\"|\"marker-mid\"|\"marker-end\"} attr\n    * @returns {Element} The marker element that is linked to the graphic element\n    */\n    function getLinked (elem, attr) {\n      if (!elem) { return null; }\n      const str = elem.getAttribute(attr);\n      if (!str) { return null; }\n\n      // const m = str.match(/\\(#(?<id>.+)\\)/);\n      // if (!m || !m.groups.id) {\n      const m = str.match(/\\(#(.*)\\)/);\n      if (!m || m.length !== 2) {\n        return null;\n      }\n      return svgCanvas.getElem(m[1]);\n      // return svgCanvas.getElem(m.groups.id);\n    }\n\n    /**\n     * Called when text is changed.\n     * @param {string} txt\n     * @returns {void}\n     */\n    function updateText (txt) {\n      const items = txt.split(';');\n      selElems.forEach((elem) => {\n        if (elem && elem.getAttribute('class').includes('placemark')) {\n          $(elem).children().each((_, i) => {\n            const [, , type, n] = i.id.split('_');\n            if (type === 'txt') {\n              $(i).text(items[n]);\n            }\n          });\n        }\n      });\n    }\n    /**\n     * Called when font is changed.\n     * @param {string} font\n     * @returns {void}\n     */\n    function updateFont (font) {\n      font = font.split(' ');\n      const fontSize = Number.parseInt(font.pop());\n      font = font.join(' ');\n      selElems.forEach((elem) => {\n        if (elem && elem.getAttribute('class').includes('placemark')) {\n          $(elem).children().each((_, i) => {\n            const [, , type] = i.id.split('_');\n            if (type === 'txt') {\n              $(i).attr({'font-family': font, 'font-size': fontSize});\n            }\n          });\n        }\n      });\n    }\n    /**\n    * @param {string} id\n    * @param {\"\"|\"\\\\nomarker\"|\"nomarker\"|\"leftarrow\"|\"rightarrow\"|\"textmarker\"|\"textmarker_top\"|\"textmarker_bottom\"|\"forwardslash\"|\"reverseslash\"|\"verticalslash\"|\"box\"|\"star\"|\"xmark\"|\"triangle\"|\"mcircle\"} val\n    * @returns {SVGMarkerElement}\n    */\n    function addMarker (id, val) {\n      let marker = svgCanvas.getElem(id);\n      if (marker) { return undefined; }\n      // console.log(id);\n      if (val === '' || val === 'nomarker') { return undefined; }\n      const color = svgCanvas.getColor('stroke');\n      // NOTE: Safari didn't like a negative value in viewBox\n      // so we use a standardized 0 0 100 100\n      // with 50 50 being mapped to the marker position\n      const scale = 2;// parseFloat($('#marker_size').val());\n      const strokeWidth = 10;\n      let refX = 50;\n      const refY = 50;\n      const viewBox = '0 0 100 100';\n      const markerWidth = 5 * scale;\n      const markerHeight = 5 * scale;\n      const seType = val;\n\n      if (!markerTypes[seType]) { return undefined; } // an unknown type!\n      // positional markers(arrows) at end of line\n      if (seType.includes('left')) refX = 0;\n      if (seType.includes('right')) refX = 100;\n\n      // create a generic marker\n      marker = addElem({\n        element: 'marker',\n        attr: {\n          id,\n          markerUnits: 'strokeWidth',\n          orient: 'auto',\n          style: 'pointer-events:none',\n          class: seType\n        }\n      });\n\n      const mel = addElem(markerTypes[seType]);\n      const fillcolor = (seType.substr(-2) === '_o')\n        ? 'none'\n        : color;\n\n      mel.setAttribute('fill', fillcolor);\n      mel.setAttribute('stroke', color);\n      mel.setAttribute('stroke-width', strokeWidth);\n      marker.append(mel);\n\n      marker.setAttribute('viewBox', viewBox);\n      marker.setAttribute('markerWidth', markerWidth);\n      marker.setAttribute('markerHeight', markerHeight);\n      marker.setAttribute('refX', refX);\n      marker.setAttribute('refY', refY);\n      svgCanvas.findDefs().append(marker);\n\n      return marker;\n    }\n    /**\n    * @param {Element} el\n    * @param {string} val\n    * @returns {void}\n    */\n    function setMarker (el, val) {\n      const markerName = 'marker-start';\n      const marker = getLinked(el, markerName);\n      if (marker) { $(marker).remove(); }\n      el.removeAttribute(markerName);\n      if (val === 'nomarker') {\n        svgCanvas.call('changed', [el]);\n        return;\n      }\n      // Set marker on element\n      const id = 'placemark_marker_' + el.id;\n      addMarker(id, val);\n      el.setAttribute(markerName, 'url(#' + id + ')');\n      svgCanvas.call('changed', [el]);\n    }\n\n    /**\n     * Called when the main system modifies an object. This routine changes\n     *   the associated markers to be the same color.\n     * @param {Element} el\n     * @returns {void}\n    */\n    function colorChanged (el) {\n      const color = el.getAttribute('stroke');\n      const marker = getLinked(el, 'marker-start');\n      // console.log(marker);\n      if (!marker) { return; }\n      if (!marker.attributes.class) { return; } // not created by this extension\n      const ch = marker.lastElementChild;\n      if (!ch) { return; }\n      const curfill = ch.getAttribute('fill');\n      const curstroke = ch.getAttribute('stroke');\n      if (curfill && curfill !== 'none') { ch.setAttribute('fill', color); }\n      if (curstroke && curstroke !== 'none') { ch.setAttribute('stroke', color); }\n    }\n\n    /**\n    * Called when the main system creates or modifies an object.\n    * Its primary purpose is to create new markers for cloned objects.\n    * @param {Element} el\n    * @returns {void}\n    */\n    function updateReferences (el) {\n      const id = 'placemark_marker_' + el.id;\n      const markerName = 'marker-start';\n      const marker = getLinked(el, markerName);\n      if (!marker || !marker.attributes.class) { return; } // not created by this extension\n      const url = el.getAttribute(markerName);\n      if (url) {\n        const len = el.id.length;\n        const linkid = url.substr(-len - 1, len);\n        if (el.id !== linkid) {\n          const val = $('#placemark_marker').attr('value') || 'leftarrow';\n          addMarker(id, val);\n          svgCanvas.changeSelectedAttribute(markerName, 'url(#' + id + ')');\n          svgCanvas.call('changed', selElems);\n        }\n      }\n    }\n    /**\n    * @param {Event} ev\n    * @returns {void}\n    */\n    function setArrowFromButton (ev) {\n      const parts = this.id.split('_');\n      let val = parts[2];\n      if (parts[3]) { val += '_' + parts[3]; }\n      $('#placemark_marker').attr('value', val);\n    }\n\n    /**\n    * @param {\"nomarker\"|\"leftarrow\"|\"rightarrow\"|\"textmarker\"|\"forwardslash\"|\"reverseslash\"|\"verticalslash\"|\"box\"|\"star\"|\"xmark\"|\"triangle\"|\"mcircle\"} id\n    * @returns {string}\n    */\n    function getTitle (id) {\n      const {langList} = strings;\n      const item = langList.find((itm) => {\n        return itm.id === id;\n      });\n      return item ? item.title : id;\n    }\n\n    /**\n    * Build the toolbar button array from the marker definitions.\n    * @param {module:SVGEditor.Button[]} buttons\n    * @returns {module:SVGEditor.Button[]}\n    */\n    function addMarkerButtons (buttons) {\n      Object.keys(markerTypes).forEach(function (id) {\n        const title = getTitle(String(id));\n        buttons.push({\n          id: 'placemark_marker_' + id,\n          svgicon: id,\n          icon: svgEditor.curConfig.extIconsPath + 'markers-' + id + '.png',\n          title,\n          type: 'context',\n          events: {click: setArrowFromButton},\n          panel: 'placemark_panel',\n          list: 'placemark_marker',\n          isDefault: id === 'leftarrow'\n        });\n      });\n      return buttons;\n    }\n\n    const buttons = [{\n      id: 'tool_placemark',\n      icon: svgEditor.curConfig.extIconsPath + 'placemark.png',\n      type: 'mode',\n      position: 12,\n      events: {\n        click () {\n          showPanel(true);\n          svgCanvas.setMode('placemark');\n        }\n      }\n    }];\n    const contextTools = [\n      {\n        type: 'button-select',\n        panel: 'placemark_panel',\n        id: 'placemark_marker',\n        colnum: 3,\n        events: {change: setArrowFromButton}\n      },\n      {\n        type: 'input',\n        panel: 'placemark_panel',\n        id: 'placemarkText',\n        size: 20,\n        defval: '',\n        events: {\n          change () {\n            updateText(this.value);\n          }\n        }\n      }, {\n        type: 'input',\n        panel: 'placemark_panel',\n        id: 'placemarkFont',\n        size: 7,\n        defval: 'Arial 10',\n        events: {\n          change () {\n            updateFont(this.value);\n          }\n        }\n      }\n    ];\n\n    return {\n      name: strings.name,\n      svgicons: svgEditor.curConfig.extIconsPath + 'placemark-icons.xml',\n      buttons: addMarkerButtons(strings.buttons.map((button, i) => {\n        return Object.assign(buttons[i], button);\n      })),\n      context_tools: strings.contextTools.map((contextTool, i) => {\n        return Object.assign(contextTools[i], contextTool);\n      }),\n      callback () {\n        $('#placemark_panel').hide();\n        // const endChanges = function(){};\n      },\n      mouseDown (opts) {\n        // const rgb = svgCanvas.getColor('fill');\n        const sRgb = svgCanvas.getColor('stroke');\n        const sWidth = svgCanvas.getStrokeWidth();\n\n        if (svgCanvas.getMode() === 'placemark') {\n          started = true;\n          const id = svgCanvas.getNextId();\n          const items = $('#placemarkText').val().split(';');\n          let font = $('#placemarkFont').val().split(' ');\n          const fontSize = Number.parseInt(font.pop());\n          font = font.join(' ');\n          const x0 = opts.start_x + 10, y0 = opts.start_y + 10;\n          let maxlen = 0;\n          const children = [{\n            element: 'line',\n            attr: {\n              id: id + '_pline_0',\n              fill: 'none',\n              stroke: sRgb,\n              'stroke-width': sWidth,\n              'stroke-linecap': 'round',\n              x1: opts.start_x,\n              y1: opts.start_y,\n              x2: x0,\n              y2: y0\n            }\n          }];\n          items.forEach((i, n) => {\n            maxlen = Math.max(maxlen, i.length);\n            children.push({\n              element: 'line',\n              attr: {\n                id: id + '_tline_' + n,\n                fill: 'none',\n                stroke: sRgb,\n                'stroke-width': sWidth,\n                'stroke-linecap': 'round',\n                x1: x0,\n                y1: y0 + (fontSize + 6) * n,\n                x2: x0 + i.length * fontSize * 0.5 + fontSize,\n                y2: y0 + (fontSize + 6) * n\n              }\n            });\n            children.push({\n              element: 'text',\n              attr: {\n                id: id + '_txt_' + n,\n                fill: sRgb,\n                stroke: 'none',\n                'stroke-width': 0,\n                x: x0 + 3,\n                y: y0 - 3 + (fontSize + 6) * n,\n                'font-family': font,\n                'font-size': fontSize,\n                'text-anchor': 'start'\n              },\n              children: [i]\n            });\n          });\n          if (items.length > 0) {\n            children.push({\n              element: 'line',\n              attr: {\n                id: id + '_vline_0',\n                fill: 'none',\n                stroke: sRgb,\n                'stroke-width': sWidth,\n                'stroke-linecap': 'round',\n                x1: x0,\n                y1: y0,\n                x2: x0,\n                y2: y0 + (fontSize + 6) * (items.length - 1)\n              }\n            });\n          }\n          newPM = svgCanvas.addSVGElementFromJson({\n            element: 'g',\n            attr: {\n              id,\n              class: 'placemark',\n              fontSize,\n              maxlen,\n              lines: items.length,\n              x: opts.start_x,\n              y: opts.start_y,\n              px: opts.start_x,\n              py: opts.start_y\n            },\n            children\n          });\n          setMarker(\n            newPM.firstElementChild,\n            $('#placemark_marker').attr('value') || 'leftarrow'\n          );\n          return {\n            started: true\n          };\n        }\n        return undefined;\n      },\n      mouseMove (opts) {\n        if (!started) {\n          return undefined;\n        }\n        if (svgCanvas.getMode() === 'placemark') {\n          const x = opts.mouse_x / svgCanvas.getZoom();\n          const y = opts.mouse_y / svgCanvas.getZoom();\n          const {fontSize, maxlen, lines, px, py} = $(newPM).attr(\n            ['fontSize', 'maxlen', 'lines', 'px', 'py']\n          );\n          $(newPM).attr({x, y});\n          $(newPM).children().each((_, i) => {\n            const [, , type, n] = i.id.split('_');\n            const y0 = y + (fontSize + 6) * n,\n              x0 = x + maxlen * fontSize * 0.5 + fontSize;\n            const nx = (x + (x0 - x) / 2 < px) ? x0 : x;\n            const ny = (y + ((fontSize + 6) * (lines - 1)) / 2 < py)\n              ? y + (fontSize + 6) * (lines - 1)\n              : y;\n            if (type === 'pline') {\n              i.setAttribute('x2', nx);\n              i.setAttribute('y2', ny);\n            }\n            if (type === 'tline') {\n              i.setAttribute('x1', x);\n              i.setAttribute('y1', y0);\n              i.setAttribute('x2', x0);\n              i.setAttribute('y2', y0);\n            }\n            if (type === 'vline') {\n              i.setAttribute('x1', nx);\n              i.setAttribute('y1', y);\n              i.setAttribute('x2', nx);\n              i.setAttribute('y2', y + (fontSize + 6) * (lines - 1));\n            }\n            if (type === 'txt') {\n              i.setAttribute('x', x + fontSize / 2);\n              i.setAttribute('y', y0 - 3);\n            }\n          });\n          return {\n            started: true\n          };\n        }\n        return undefined;\n      },\n      mouseUp () {\n        if (svgCanvas.getMode() === 'placemark') {\n          const {x, y, px, py} = $(newPM).attr(['x', 'y', 'px', 'py']);\n          return {\n            keep: (x != px && y != py), // eslint-disable-line eqeqeq\n            element: newPM\n          };\n        }\n        return undefined;\n      },\n      selectedChanged (opts) {\n        // Use this to update the current selected elements\n        selElems = opts.elems;\n        selElems.forEach((elem) => {\n          if (elem && elem.getAttribute('class').includes('placemark')) {\n            const txt = [];\n            $(elem).children().each((n, i) => {\n              const [, , type] = i.id.split('_');\n              if (type === 'txt') {\n                $('#placemarkFont').val(\n                  i.getAttribute('font-family') + ' ' + i.getAttribute('font-size')\n                );\n                txt.push($(i).text());\n              }\n            });\n            $('#placemarkText').val(txt.join(';'));\n            showPanel(true);\n          } else {\n            showPanel(false);\n          }\n        });\n      },\n      elementChanged (opts) {\n        opts.elems.forEach((elem) => {\n          if (elem.id.includes('pline_0')) { // need update marker of pline_0\n            colorChanged(elem);\n            updateReferences(elem);\n          }\n        });\n      }\n    };\n  }\n};\n"],"names":["name","init","S","showPanel","getLinked","updateText","updateFont","addMarker","setMarker","colorChanged","updateReferences","setArrowFromButton","getTitle","addMarkerButtons","buttons","Object","keys","markerTypes","forEach","id","title","String","push","svgicon","icon","svgEditor","curConfig","extIconsPath","type","events","click","panel","list","isDefault","langList","strings","item","find","itm","ev","parts","split","val","$","attr","el","markerName","marker","attributes","url","getAttribute","len","length","linkid","substr","svgCanvas","changeSelectedAttribute","call","selElems","color","ch","lastElementChild","curfill","curstroke","setAttribute","remove","removeAttribute","getElem","undefined","getColor","scale","strokeWidth","refX","refY","viewBox","markerWidth","markerHeight","seType","includes","addElem","element","markerUnits","orient","style","mel","fillcolor","append","findDefs","font","fontSize","Number","parseInt","pop","join","elem","children","each","_","i","txt","items","n","text","str","m","match","on","toggle","canvas","addSVGElementFromJson","importLocale","nomarker","forwardslash","d","reverseslash","verticalslash","xmark","leftarrow","rightarrow","box","star","mcircle","r","cx","cy","triangle","v","position","setMode","contextTools","colnum","change","size","defval","value","svgicons","map","button","assign","context_tools","contextTool","callback","hide","mouseDown","opts","sRgb","sWidth","getStrokeWidth","getMode","started","getNextId","x0","start_x","y0","start_y","maxlen","fill","stroke","x1","y1","x2","y2","Math","max","x","y","newPM","lines","px","py","firstElementChild","mouseMove","mouse_x","getZoom","mouse_y","nx","ny","mouseUp","keep","selectedChanged","elems","elementChanged"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}