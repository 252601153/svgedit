function asyncGeneratorStep(e,t,r,n,a,i,o){try{var l=e[i](o),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function _next(e){asyncGeneratorStep(i,n,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(i,n,a,_next,_throw,"throw",e)}_next(void 0)}))}}
/**
 * @file ext-arrows.js
 *
 * @license MIT
 *
 * @copyright 2010 Alexis Deveria
 *
 */var e={name:"arrows",init:function init(e){var t=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var r,n,a,i,o,l,c,u,d,s,f,m,h,v,k,_,g,b,p,w,x;return regeneratorRuntime.wrap((function _callee2$(A){for(;;)switch(A.prev=A.next){case 0:return w=function _colorChanged(t){var r=t.getAttribute("stroke"),n=["start","mid","end"],a=i.findDefs();c.each(n,(function(i,o){var l=k(t,"marker-"+o);if(l){var u=c(l).children().attr("fill"),d=c(l).children().attr("d");if(u!==r){var f=c(a).find("marker"),m=null;if(f.each((function(){var e=c(this).children().attr(["fill","d"]);e.fill===r&&e.d===d&&(m=this)})),!m){var h=l.id.includes("_fw")?"fw":"bk";m=b(h,o,s+h+f.length),c(m).children().attr("fill",r)}c(t).attr("marker-"+o,"url(#"+m.id+")");var v=!0;c(e.svgcontent).find("line, polyline, path, polygon").each((function(){var e=this;if(c.each(n,(function(t,r){if(c(e).attr("marker-"+r)==="url(#"+l.id+")")return v=!1})),!v)return!1})),v&&c(l).remove()}}}))},p=function _setArrow(){g();var e=this.value;if("none"!==e){var t="fw";"mid_bk"===e?(e="mid",t="bk"):"both"===e?(b("bk",e),i.changeSelectedAttribute("marker-start","url(#"+v.bk.id+")"),e="end",t="fw"):"start"===e&&(t="bk"),b(t,e),i.changeSelectedAttribute("marker-"+e,"url(#"+v[t].id+")"),i.call("changed",d)}},b=function _addMarker(e,t,r){r=r||s+e;var n=v[e];"mid"===t&&(n.refx=5);var a=i.getElem(r);if(!a){a=o({element:"marker",attr:{viewBox:"0 0 10 10",id:r,refY:5,markerUnits:"strokeWidth",markerWidth:5,markerHeight:5,orient:"auto",style:"pointer-events:none"}});var l=o({element:"path",attr:{d:n.d,fill:"#000000"}});a.append(l),i.findDefs().append(a)}return a.setAttribute("refX",n.refx),a},g=function _resetMarker(){var e=d[0];e.removeAttribute("marker-start"),e.removeAttribute("marker-mid"),e.removeAttribute("marker-end")},_=function _showPanel(e){if(c("#arrow_panel").toggle(e),e){var t,r=d[0],n=r.getAttribute("marker-end"),a=r.getAttribute("marker-start"),i=r.getAttribute("marker-mid");n&&a?t="both":n?t="end":a?t="start":i&&(t="mid",i.includes("bk")&&(t="mid_bk")),a||i||n||(t="none"),c("#arrow_list").val(t)}},k=function _getLinked(e,t){var r=e.getAttribute(t);if(!r)return null;var n=r.match(/\(#(.*)\)/);return n&&2===n.length?i.getElem(n[1]):null},h=function _unsetArrowNonce(e){f=!1,s=u,v.fw.id=s+"fw",v.bk.id=s+"bk"},m=function _setArrowNonce(e,t){f=!0,s=u+t+"_",v.fw.id=s+"fw",v.bk.id=s+"bk"},r=t,A.next=11,import("./locale/".concat(r.curPrefs.lang,".js"));case 11:return n=A.sent,a=n.default,i=r.canvas,o=i.addSVGElementFromJson,l=e.nonce,c=e.$,u="se_arrow_",f=e.randomize_ids,i.bind("setnonce",m),i.bind("unsetnonce",h),v={fw:{d:"m0,0l10,5l-10,5l5,-5l-5,-5z",refx:8,id:(s=f?u+l+"_":u)+"fw"},bk:{d:"m10,0l-10,5l10,5l-5,-5l5,-5z",refx:2,id:s+"bk"}},x=[{type:"select",panel:"arrow_panel",id:"arrow_list",defval:"none",events:{change:p}}],A.abrupt("return",{name:a.name,context_tools:a.contextTools.map((function(e,t){return Object.assign(x[t],e)})),callback:function callback(){c("#arrow_panel").hide(),c("#arrow_list option")[0].id="connector_no_arrow"},addLangData:function addLangData(e){return _asyncToGenerator(regeneratorRuntime.mark((function _callee(){var t,r,n;return regeneratorRuntime.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return e.lang,t=e.importLocale,a.next=3,t();case 3:return r=a.sent,n=r.langList,a.abrupt("return",{data:n});case 6:case"end":return a.stop()}}),_callee)})))()},selectedChanged:function selectedChanged(e){for(var t=["line","path","polyline","polygon"],r=(d=e.elems).length;r--;){var n=d[r];n&&t.includes(n.tagName)&&e.selectedElement&&!e.multiselected?_(!0):_(!1)}},elementChanged:function elementChanged(e){var t=e.elems[0];t&&(t.getAttribute("marker-start")||t.getAttribute("marker-mid")||t.getAttribute("marker-end"))&&w(t)}});case 22:case"end":return A.stop()}}),_callee2)})))()}};export default e;
//# sourceMappingURL=ext-arrows.js.map
